var stb=stb||{},mediaStrings=stbUserOptions.strings;(function(n){function i(n){return typeof n.radius=="string"&&(n.radius=parseInt(n.radius)),typeof n.imgX=="string"&&(n.imgX=parseInt(n.imgX)),typeof n.imgY=="string"&&(n.imgY=parseInt(n.imgY)),n}var t;stb.media=t={jsId:"#selJsImg",cssId:"#selCssImg",jsImgUrl:"#js_image",cssImgUrl:"#css_big_image",init:function(){n(this.jsId).on("click",{mode:"js"},this.openMediaDialog);n(this.cssId).on("click",{mode:"css"},this.openMediaDialog)},openMediaDialog:function(n){n.preventDefault();var i=n.data.mode;if(this._frame){this._frame.open();return}this._frame=t.frame=wp.media({title:mediaStrings.title,button:{text:mediaStrings.update},multiple:!1,library:{type:"image"}});this._frame.on("ready",function(){});this._frame.state("library").on("select",function(){var n=this.get("selection").single();t.handleMediaAttachment(n,i)});this._frame.open()},handleMediaAttachment:function(t,i){var r=t.toJSON();i=="js"?n(this.jsImgUrl).val(r.url):n(this.cssImgUrl).val(r.url)}};n(document).ready(function(){function e(n){return n.toggleClass("stb-hidden").toggleClass("stb-visible"),!1}var o=n("#style_slug").val(),s={image:n("#js_image").val(),color:"#"+n("#js_color").val(),colorTo:"#"+n("#js_color_to").val(),fontColor:"#"+n("#js_font_color").val(),border:{width:n("#js_border_width").val(),color:"#"+n("#js_border_color").val()},caption:{fontColor:"#"+n("#js_caption_font_color").val(),color:"#"+n("#js_caption_color").val(),colorTo:"#"+n("#js_caption_color_to").val()}},u=i(stbUserOptions.jsOptions),h=u.pickerOptions,f={direction:"vertical"},r;"Undefined"!=o&&n("#js_test, #js_test_cap").stb(s,u);t.init();r=stbUserOptions.cssOptions;n(".stb-tool").bind("click",function(){var s=n(this).attr("id").split("-"),t=s[2],i=n("#stb-container-"+t),u=n("#stb-body-box-"+t),o=n("#stb-toolimg-"+t);return i.hasClass("stb-visible")?(u.hide("blind",f,500,function(){e(i)}),o.attr({src:r.imgShow,title:r.strShow})):(u.show("blind",f,500,function(){e(i)}),o.attr({src:r.imgHide,title:r.strHide})),!1});try{n(".color-btn").smallColorPicker({placement:{popup:!0},texts:h.texts}).on({scp_ok:function(t,i){n("#"+t.target.id.replace("-button","")).val(i.replace("#",""));n("#"+t.target.id).html('<b style="background-color: '+i+';"><\/b>'+i.replace("#","").toUpperCase())}})}catch(c){}})})(jQuery)